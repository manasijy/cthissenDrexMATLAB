function map = rdylbu(m)
%rdylbu color map
%   rdylbu(M) returns an M-by-3 matrix containing a colormap with cool-to-warm
%   colors, as commonly used in Paraview.
%   rdylbu, by itself, is the same length as the current colormap.
%
%   For example, to reset the colormap of the current figure:
%
%             colormap(rdylbu)

% Christopher Thissen
% Yale University
% Time-stamp: <Mar 25, 2015>
%% Check inputs
narginchk(0,1);

if nargin == 1
    validateattributes(m,{'numeric'},{'numel',1});
end

%% Begin Function
if nargin < 1, m = size(get(gcf,'colormap'),1); end
c = ...
 [ 146.0000         0   29.0000
  147.9572    1.2952   29.2303
  149.9145    2.5905   29.4605
  151.8717    3.8857   29.6908
  153.8289    5.1809   29.9211
  155.7862    6.4761   30.1513
  157.7434    7.7714   30.3816
  159.7006    9.0666   30.6118
  161.6579   10.3618   30.8421
  163.6151   11.6570   31.0724
  165.5723   12.9523   31.3026
  167.5296   14.2475   31.5329
  169.4868   15.5427   31.7632
  171.4440   16.8380   31.9934
  173.4013   18.1332   32.2237
  175.3585   19.4284   32.4539
  177.3157   20.7236   32.6842
  179.2730   22.0189   32.9145
  181.2302   23.3141   33.1447
  183.1874   24.6093   33.3750
  185.1447   25.9046   33.6053
  187.1019   27.1998   33.8355
  189.0591   28.4950   34.0658
  191.0164   29.7902   34.2960
  192.9736   31.0855   34.5263
  194.9308   32.3807   34.7566
  196.8881   33.6759   34.9868
  198.8453   34.9711   35.2171
  200.8025   36.2664   35.4474
  202.7597   37.5616   35.6776
  204.7170   38.8568   35.9079
  206.6742   40.1521   36.1381
  208.6314   41.4473   36.3684
  210.5887   42.7425   36.5987
  212.5459   44.0377   36.8289
  214.2558   45.6479   37.2387
  215.2506   48.1683   38.1673
  216.2455   50.6887   39.0958
  217.2404   53.2090   40.0244
  218.2353   55.7294   40.9529
  219.2302   58.2498   41.8815
  220.2251   60.7702   42.8101
  221.2199   63.2905   43.7386
  222.2148   65.8109   44.6672
  223.2097   68.3313   45.5957
  224.2046   70.8517   46.5243
  225.1995   73.3720   47.4529
  226.1944   75.8924   48.3814
  227.1893   78.4128   49.3100
  228.1841   80.9332   50.2385
  229.1790   83.4535   51.1671
  230.1739   85.9739   52.0957
  231.1688   88.4943   53.0242
  232.1637   91.0147   53.9528
  233.1586   93.5350   54.8813
  234.1535   96.0554   55.8099
  235.1483   98.5758   56.7384
  236.1432  101.0962   57.6670
  237.1381  103.6165   58.5956
  238.1330  106.1369   59.5241
  239.1279  108.6573   60.4527
  240.1228  111.1777   61.3812
  241.1176  113.6980   62.3098
  242.1125  116.2184   63.2384
  243.1074  118.7388   64.1669
  244.0244  121.2649   65.1534
  244.2617  123.8413   66.6450
  244.4990  126.4177   68.1366
  244.7363  128.9941   69.6281
  244.9736  131.5705   71.1197
  245.2109  134.1468   72.6113
  245.4482  136.7232   74.1029
  245.6855  139.2996   75.5945
  245.9228  141.8760   77.0861
  246.1601  144.4524   78.5777
  246.3974  147.0288   80.0693
  246.6347  149.6051   81.5609
  246.8720  152.1815   83.0525
  247.1093  154.7579   84.5441
  247.3466  157.3343   86.0356
  247.5839  159.9107   87.5272
  247.8212  162.4871   89.0188
  248.0585  165.0634   90.5104
  248.2958  167.6398   92.0020
  248.5331  170.2162   93.4936
  248.7704  172.7926   94.9852
  249.0077  175.3690   96.4768
  249.2450  177.9454   97.9684
  249.4823  180.5217   99.4600
  249.7196  183.0981  100.9515
  249.9569  185.6745  102.4431
  250.1942  188.2509  103.9347
  250.4315  190.8273  105.4263
  250.6688  193.4037  106.9179
  250.9061  195.9800  108.4095
  251.0576  198.1808  110.2096
  251.1529  200.1353  112.2118
  251.2483  202.0898  114.2140
  251.3436  204.0444  116.2162
  251.4390  205.9989  118.2184
  251.5343  207.9534  120.2206
  251.6297  209.9080  122.2228
  251.7250  211.8625  124.2250
  251.8203  213.8170  126.2272
  251.9157  215.7716  128.2294
  252.0110  217.7261  130.2316
  252.1064  219.6806  132.2338
  252.2017  221.6352  134.2360
  252.2971  223.5897  136.2382
  252.3924  225.5442  138.2404
  252.4877  227.4988  140.2426
  252.5831  229.4533  142.2449
  252.6784  231.4078  144.2471
  252.7738  233.3624  146.2493
  252.8691  235.3169  148.2515
  252.9645  237.2714  150.2537
  252.8469  238.6124  152.3396
  252.6028  239.5887  154.4753
  252.3587  240.5650  156.6110
  252.1147  241.5413  158.7467
  251.8706  242.5176  160.8824
  251.6265  243.4940  163.0180
  251.3824  244.4703  165.1537
  251.1384  245.4466  167.2894
  250.8943  246.4229  169.4251
  250.6502  247.3992  171.5608
  250.4061  248.3755  173.6965
  250.1620  249.3518  175.8322
  249.9180  250.3282  177.9678
  249.6739  251.3045  180.1035
  249.4298  252.2808  182.2392
  249.1857  253.2571  184.3749
  248.6353  253.8437  186.6513
  247.1098  253.1899  189.3754
  245.5843  252.5361  192.0994
  244.0588  251.8824  194.8235
  242.5333  251.2286  197.5476
  241.0078  250.5748  200.2717
  239.4824  249.9210  202.9958
  237.9569  249.2672  205.7199
  236.4314  248.6134  208.4440
  234.9059  247.9597  211.1681
  233.3804  247.3059  213.8922
  231.8549  246.6521  216.6162
  230.3294  245.9983  219.3403
  228.8039  245.3445  222.0644
  227.2784  244.6908  224.7885
  225.7529  244.0370  227.5126
  224.2275  243.3832  230.2367
  222.7020  242.7294  232.9608
  221.1765  242.0756  235.6849
  218.9765  240.8585  235.5849
  216.6882  239.5677  235.1155
  214.4000  238.2769  234.6462
  212.1118  236.9861  234.1768
  209.8235  235.6953  233.7074
  207.5353  234.4045  233.2380
  205.2471  233.1137  232.7686
  202.9588  231.8229  232.2992
  200.6706  230.5321  231.8299
  198.3824  229.2413  231.3605
  196.0941  227.9505  230.8911
  193.8059  226.6597  230.4217
  191.5176  225.3689  229.9523
  189.2294  224.0781  229.4830
  186.9412  222.7873  229.0136
  184.6529  221.4965  228.5442
  182.3647  220.2057  228.0748
  180.0765  218.9149  227.6054
  177.7882  217.6241  227.1360
  175.5000  216.3333  226.6667
  173.2118  215.0425  226.1973
  170.9235  213.7517  225.7279
  168.6353  212.4609  225.2585
  166.3471  211.1701  224.7891
  164.0588  209.8793  224.3198
  161.7706  208.5885  223.8504
  159.4824  207.2977  223.3810
  157.1941  206.0069  222.9116
  154.9059  204.7161  222.4422
  152.6176  203.4253  221.9729
  150.3294  202.1345  221.5035
  148.0412  200.8437  221.0341
  145.7529  199.5529  220.5647
  143.4647  198.2621  220.0953
  141.3086  196.2029  219.0222
  139.1862  193.9478  217.7951
  137.0638  191.6928  216.5681
  134.9413  189.4377  215.3411
  132.8189  187.1826  214.1141
  130.6965  184.9275  212.8870
  128.5741  182.6725  211.6600
  126.4517  180.4174  210.4330
  124.3292  178.1623  209.2060
  122.2068  175.9072  207.9789
  120.0844  173.6522  206.7519
  117.9620  171.3971  205.5249
  115.8396  169.1420  204.2979
  113.7171  166.8870  203.0708
  111.5947  164.6319  201.8438
  109.4723  162.3768  200.6168
  107.3499  160.1217  199.3898
  105.2275  157.8667  198.1627
  103.1050  155.6116  196.9357
  100.9826  153.3565  195.7087
   98.8602  151.1014  194.4817
   96.7378  148.8464  193.2546
   94.6153  146.5913  192.0276
   92.4929  144.3362  190.8006
   90.3705  142.0812  189.5736
   88.2481  139.8261  188.3465
   86.1257  137.5710  187.1195
   84.0032  135.3159  185.8925
   81.8808  133.0609  184.6655
   79.7584  130.8058  183.4384
   78.3359  128.5136  182.1619
   77.3025  126.2008  180.8579
   76.2691  123.8879  179.5538
   75.2357  121.5751  178.2498
   74.2023  119.2622  176.9457
   73.1689  116.9494  175.6417
   72.1355  114.6366  174.3376
   71.1021  112.3237  173.0336
   70.0687  110.0109  171.7295
   69.0353  107.6980  170.4255
   68.0019  105.3852  169.1214
   66.9685  103.0724  167.8174
   65.9351  100.7595  166.5133
   64.9017   98.4467  165.2093
   63.8683   96.1338  163.9052
   62.8349   93.8210  162.6012
   61.8015   91.5082  161.2972
   60.7681   89.1953  159.9931
   59.7347   86.8825  158.6891
   58.7013   84.5696  157.3850
   57.6679   82.2568  156.0810
   56.6345   79.9440  154.7769
   55.6011   77.6311  153.4729
   54.5677   75.3183  152.1688
   53.5343   73.0054  150.8648
   52.5009   70.6926  149.5607
   51.4676   68.3798  148.2567
   50.4342   66.0669  146.9526
   49.4008   63.7541  145.6486
   48.3674   61.4412  144.3445
   47.3340   59.1284  143.0405
   46.3006   56.8156  141.7364
   45.2672   54.5027  140.4324
   44.2338   52.1899  139.1283
   43.2004   49.8770  137.8243
   42.1670   47.5642  136.5202
   41.1336   45.2514  135.2162
   40.1002   42.9385  133.9121
   39.0668   40.6257  132.6081
   38.0334   38.3128  131.3040
   37.0000   36.0000  130.0000];
 
 

    
%... Interpolate get requested size for color table
pp=1:(m-1)/(size(c,1)-1):m;
r=interp1(pp,c(:,1),1:m);
g=interp1(pp,c(:,2),1:m);
b=interp1(pp,c(:,3),1:m);
%... Normalize to range [0,1], and divide again by maximum value
% to correct for round-off errors associated with the interpolation.
map=[r' g' b']/256;
map = map/max(map(:));


%% cpt file is incorrect. 
% a correct was created using photoshop's color sampler tool
% x = ([30 83 129 174 206 231 259 311 357 419]-30)/(419-30); 
% cOrig = [ ...
% 146    0   29;
% 214   45   37;
% 244  121   65;
% 251  197  109;
% 253  238  151;
% 249  254  186;
% 221  242  236;
% 143  198  220;
% 079  130  183;
% 037  036  130];
% 
% xI = linspace(0,1,256);
% rI = interp1(x,cOrig(:,1),xI)';
% gI = interp1(x,cOrig(:,2),xI)';
% bI = interp1(x,cOrig(:,3),xI)';
% c = [rI,gI,bI]



