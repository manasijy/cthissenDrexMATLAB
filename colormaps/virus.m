function map = virus(m)
%virus color map
%   virus(M) returns an M-by-3 matrix containing a colormap with cool-to-warm
%   colors, as commonly used in Paraview.
%   rdylbu, by itself, is the same length as the current colormap.
%
%   For example, to reset the colormap of the current figure:
%
%             colormap(virus)
%
% The code structure follows coolwarm.m by Mark Brandon (Yale).

% Christopher Thissen
% Yale University
% Time-stamp: <Mar 25, 2015>
%% Check inputs
narginchk(0,1);

if nargin == 1
    validateattributes(m,{'numeric'},{'numel',1});
end

%% Begin Function
if nargin < 1, m = size(get(gcf,'colormap'),1); end
c = ...
 [         0         0    6.0000
         0    0.4078    8.1647
         0    0.8157   10.3294
         0    1.2235   12.4941
         0    1.6314   14.6588
         0    2.0392   16.8235
         0    2.4471   18.9882
         0    2.8549   21.1529
         0    3.2627   23.3176
         0    3.6706   25.4824
         0    4.0784   27.6471
         0    4.4863   29.8118
         0    4.8941   31.9765
         0    5.3020   34.1412
         0    5.7098   36.3059
         0    6.1176   38.4706
         0    6.5255   40.6353
         0    6.9333   42.8000
         0    7.3412   44.9647
         0    7.7490   47.1294
         0    8.1569   49.2941
         0    8.5647   51.4588
         0    8.9725   53.6235
         0    9.3804   55.7882
         0    9.7882   57.9529
         0   10.1961   60.1176
         0   10.6039   62.2824
         0   11.0118   64.4471
         0   11.4196   66.6118
         0   11.8275   68.7765
         0   12.2353   70.9412
         0   12.6431   73.1059
         0   13.3412   75.0980
         0   16.0706   75.8824
         0   18.8000   76.6667
         0   21.5294   77.4510
         0   24.2588   78.2353
         0   26.9882   79.0196
         0   29.7176   79.8039
         0   32.4471   80.5882
         0   35.1765   81.3725
         0   37.9059   82.1569
         0   40.6353   82.9412
         0   43.3647   83.7255
         0   46.0941   84.5098
         0   48.8235   85.2941
         0   51.5529   86.0784
         0   54.2824   86.8627
         0   57.0118   87.6471
         0   59.7412   88.4314
         0   62.4706   89.2157
         0   65.2000   90.0000
         0   67.9294   90.7843
         0   70.6588   91.5686
         0   73.3882   92.3529
         0   76.1176   93.1373
         0   78.8471   93.9216
         0   81.5765   94.7059
         0   84.3059   95.4902
         0   87.0353   96.2745
         0   89.7647   97.0588
         0   92.4941   97.8431
         0   95.2235   98.6275
         0   97.9529   99.4118
         0  100.3765   99.5451
         0  101.8824   97.7255
         0  103.3882   95.9059
         0  104.8941   94.0863
         0  106.4000   92.2667
         0  107.9059   90.4471
         0  109.4118   88.6275
         0  110.9176   86.8078
         0  112.4235   84.9882
         0  113.9294   83.1686
         0  115.4353   81.3490
         0  116.9412   79.5294
         0  118.4471   77.7098
         0  119.9529   75.8902
         0  121.4588   74.0706
         0  122.9647   72.2510
         0  124.4706   70.4314
         0  125.9765   68.6118
         0  127.4824   66.7922
         0  128.9882   64.9725
         0  130.4941   63.1529
         0  132.0000   61.3333
         0  133.5059   59.5137
         0  135.0118   57.6941
         0  136.5176   55.8745
         0  138.0235   54.0549
         0  139.5294   52.2353
         0  141.0353   50.4157
         0  142.5412   48.5961
         0  144.0471   46.7765
         0  145.5529   44.9569
         0  147.0588   43.1373
    1.3176  147.4706   41.5059
    4.8314  146.0588   40.1882
    8.3451  144.6471   38.8706
   11.8588  143.2353   37.5529
   15.3725  141.8235   36.2353
   18.8863  140.4118   34.9176
   22.4000  139.0000   33.6000
   25.9137  137.5882   32.2824
   29.4275  136.1765   30.9647
   32.9412  134.7647   29.6471
   36.4549  133.3529   28.3294
   39.9686  131.9412   27.0118
   43.4824  130.5294   25.6941
   46.9961  129.1176   24.3765
   50.5098  127.7059   23.0588
   54.0235  126.2941   21.7412
   57.5373  124.8824   20.4235
   61.0510  123.4706   19.1059
   64.5647  122.0588   17.7882
   68.0784  120.6471   16.4706
   71.5922  119.2353   15.1529
   75.1059  117.8235   13.8353
   78.6196  116.4118   12.5176
   82.1333  115.0000   11.2000
   85.6471  113.5882    9.8824
   89.1608  112.1765    8.5647
   92.6745  110.7647    7.2471
   96.1882  109.3529    5.9294
   99.7020  107.9412    4.6118
  103.2157  106.5294    3.2941
  106.7294  105.1176    1.9765
  110.2431  103.7059    0.6588
  113.4902  101.9333         0
  116.4706   99.8000         0
  119.4510   97.6667         0
  122.4314   95.5333         0
  125.4118   93.4000         0
  128.3922   91.2667         0
  131.3725   89.1333         0
  134.3529   87.0000         0
  137.3333   84.8667         0
  140.3137   82.7333         0
  143.2941   80.6000         0
  146.2745   78.4667         0
  149.2549   76.3333         0
  152.2353   74.2000         0
  155.2157   72.0667         0
  158.1961   69.9333         0
  161.1765   67.8000         0
  164.1569   65.6667         0
  167.1373   63.5333         0
  170.1176   61.4000         0
  173.0980   59.2667         0
  176.0784   57.1333         0
  179.0588   55.0000         0
  182.0392   52.8667         0
  185.0196   50.7333         0
  188.0000   48.6000         0
  190.9804   46.4667         0
  193.9608   44.3333         0
  196.9412   42.2000         0
  199.9216   40.0667         0
  202.9020   37.9333         0
  205.8824   35.8000         0
  207.3333   36.5098         0
  207.8667   38.9255         0
  208.4000   41.3412         0
  208.9333   43.7569         0
  209.4667   46.1725         0
  210.0000   48.5882         0
  210.5333   51.0039         0
  211.0667   53.4196         0
  211.6000   55.8353         0
  212.1333   58.2510         0
  212.6667   60.6667         0
  213.2000   63.0824         0
  213.7333   65.4980         0
  214.2667   67.9137         0
  214.8000   70.3294         0
  215.3333   72.7451         0
  215.8667   75.1608         0
  216.4000   77.5765         0
  216.9333   79.9922         0
  217.4667   82.4078         0
  218.0000   84.8235         0
  218.5333   87.2392         0
  219.0667   89.6549         0
  219.6000   92.0706         0
  220.1333   94.4863         0
  220.6667   96.9020         0
  221.2000   99.3176         0
  221.7333  101.7333         0
  222.2667  104.1490         0
  222.8000  106.5647         0
  223.3333  108.9804         0
  223.8667  111.3961         0
  224.3529  113.5765         0
  224.8235  115.6784         0
  225.2941  117.7804         0
  225.7647  119.8824         0
  226.2353  121.9843         0
  226.7059  124.0863         0
  227.1765  126.1882         0
  227.6471  128.2902         0
  228.1176  130.3922         0
  228.5882  132.4941         0
  229.0588  134.5961         0
  229.5294  136.6980         0
  230.0000  138.8000         0
  230.4706  140.9020         0
  230.9412  143.0039         0
  231.4118  145.1059         0
  231.8824  147.2078         0
  232.3529  149.3098         0
  232.8235  151.4118         0
  233.2941  153.5137         0
  233.7647  155.6157         0
  234.2353  157.7176         0
  234.7059  159.8196         0
  235.1765  161.9216         0
  235.6471  164.0235         0
  236.1176  166.1255         0
  236.5882  168.2275         0
  237.0588  170.3294         0
  237.5294  172.4314         0
  238.0000  174.5333         0
  238.4706  176.6353         0
  238.9412  178.7373         0
  239.4118  180.9490         0
  239.8824  183.1765         0
  240.3529  185.4039         0
  240.8235  187.6314         0
  241.2941  189.8588         0
  241.7647  192.0863         0
  242.2353  194.3137         0
  242.7059  196.5412         0
  243.1765  198.7686         0
  243.6471  200.9961         0
  244.1176  203.2235         0
  244.5882  205.4510         0
  245.0588  207.6784         0
  245.5294  209.9059         0
  246.0000  212.1333         0
  246.4706  214.3608         0
  246.9412  216.5882         0
  247.4118  218.8157         0
  247.8824  221.0431         0
  248.3529  223.2706         0
  248.8235  225.4980         0
  249.2941  227.7255         0
  249.7647  229.9529         0
  250.2353  232.1804         0
  250.7059  234.4078         0
  251.1765  236.6353         0
  251.6471  238.8627         0
  252.1176  241.0902         0
  252.5882  243.3176         0
  253.0588  245.5451         0
  253.5294  247.7725         0
  254.0000  250.0000         0];
 
 

    
%... Interpolate get requested size for color table
pp=1:(m-1)/(size(c,1)-1):m;
r=interp1(pp,c(:,1),1:m);
g=interp1(pp,c(:,2),1:m);
b=interp1(pp,c(:,3),1:m);
%... Normalize to range [0,1], and divide again by maximum value
% to correct for round-off errors associated with the interpolation.
map=[r' g' b']/256;
map = map/max(map(:));

%% LINT - Generate c matrix
% interpolate to linear spacing (used to generate c matrix above)
% x = [0:1:8] / 8;
% cOrig = ...
% [  0    0    6;
%    0   13   75;
%    0  100  100;
%    0  148   42;
%  112  103    0;
%  207   35    0;
%  224  112    0;
%  239  179    0;
%  254  250    0];
%   
% xI = linspace(0,1,256);
% rI = interp1(x,cOrig(:,1),xI)';
% gI = interp1(x,cOrig(:,2),xI)';
% bI = interp1(x,cOrig(:,3),xI)';
% c = [rI,gI,bI]

%% LINT - original .cpt file
% # autogenerated GMT palette "virus.txt"
% # cptutils version 1.31, Thu Jun 11 01:59:11 2009
% # COLOR_MODEL = RGB
% 0.000000e+00   0   0   6 1.000000e+00   0  13  75
% 1.000000e+00   0  13  75 2.000000e+00   0 100 100
% 2.000000e+00   0 100 100 3.000000e+00   0 148  42
% 3.000000e+00   0 148  42 4.000000e+00 112 103   0
% 4.000000e+00 112 103   0 5.000000e+00 207  35   0
% 5.000000e+00 207  35   0 6.000000e+00 224 112   0
% 6.000000e+00 224 112   0 7.000000e+00 239 179   0
% 7.000000e+00 239 179   0 8.000000e+00 254 250   0
% B   0   0   0
% F 255 255 255
% N 255   0   0










