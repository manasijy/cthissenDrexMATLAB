function map = hklcolor(m)
%hklcolor color map
%   hklcolor(M) returns an M-by-3 matrix containing a colormap with cool-to-warm
%   colors, as commonly used in Paraview.
%   rdylbu, by itself, is the same length as the current colormap.
%
%   For example, to reset the colormap of the current figure:
%
%             colormap(hklcolor)
%
% The code structure follows coolwarm.m by Mark Brandon (Yale).

% Christopher Thissen
% Yale University
% Time-stamp: <Mar 25, 2015>
%% Check inputs
narginchk(0,1);

if nargin == 1
    validateattributes(m,{'numeric'},{'numel',1});
end

%% Begin Function
if nargin < 1, m = size(get(gcf,'colormap'),1); end
c = ...
 [ 42.0000   61.0000  153.0000
   40.7911   62.5255  153.9786
   39.5822   64.0510  154.9572
   38.3734   65.5765  155.9358
   37.1645   67.1020  156.9145
   35.9556   68.6275  157.8931
   34.7467   70.1529  158.8717
   33.5378   71.6784  159.8503
   32.3290   73.2039  160.8289
   31.1201   74.7294  161.8075
   29.9112   76.2549  162.7862
   28.7023   77.7804  163.7648
   27.4935   79.3059  164.7434
   26.2846   80.8314  165.7220
   25.0757   82.3569  166.7006
   23.8668   83.8824  167.6792
   22.6579   85.4078  168.6579
   21.4491   86.9333  169.6365
   20.2402   88.4588  170.6151
   19.0313   89.9843  171.5937
   17.8224   91.5098  172.5723
   16.6135   93.0353  173.5509
   15.4047   94.5608  174.5296
   14.1958   96.0863  175.5082
   12.9869   97.6118  176.4868
   11.7780   99.1373  177.4654
   10.5691  100.6627  178.4440
    9.3603  102.1882  179.4226
    8.1514  103.7137  180.4013
    6.9425  105.2392  181.3799
    5.7336  106.7647  182.3585
    4.5248  108.2902  183.3371
    3.3159  109.8157  184.3157
    2.1070  111.3412  185.2943
    0.8981  112.8667  186.2730
         0  114.4518  186.5482
         0  116.2095  184.7905
         0  117.9671  183.0329
         0  119.7247  181.2753
         0  121.4824  179.5176
         0  123.2400  177.7600
         0  124.9976  176.0024
         0  126.7552  174.2448
         0  128.5129  172.4871
         0  130.2705  170.7295
         0  132.0281  168.9719
         0  133.7858  167.2142
         0  135.5434  165.4566
         0  137.3010  163.6990
         0  139.0587  161.9413
         0  140.8163  160.1837
         0  142.5739  158.4261
         0  144.3315  156.6685
         0  146.0892  154.9108
         0  147.8468  153.1532
         0  149.6044  151.3956
         0  151.3621  149.6379
         0  153.1197  147.8803
         0  154.8773  146.1227
         0  156.6350  144.3650
         0  158.3926  142.6074
         0  160.1502  140.8498
         0  161.9078  139.0922
         0  163.6655  137.3345
         0  165.4231  135.5769
         0  167.0139  133.8083
         0  167.1495  131.9438
         0  167.2851  130.0793
         0  167.4207  128.2148
         0  167.5563  126.3503
         0  167.6919  124.4858
         0  167.8275  122.6214
         0  167.9631  120.7569
         0  168.0987  118.8924
         0  168.2343  117.0279
         0  168.3699  115.1634
         0  168.5055  113.2989
         0  168.6411  111.4344
         0  168.7767  109.5699
         0  168.9123  107.7054
         0  169.0479  105.8410
         0  169.1835  103.9765
         0  169.3191  102.1120
         0  169.4547  100.2475
         0  169.5903   98.3830
         0  169.7259   96.5185
         0  169.8615   94.6540
         0  169.9971   92.7895
         0  170.1327   90.9251
         0  170.2683   89.0606
         0  170.4039   87.1961
         0  170.5395   85.3316
         0  170.6751   83.4671
         0  170.8107   81.6026
         0  170.9463   79.7381
    2.0159  171.3456   78.8272
    5.3529  171.9176   78.5412
    8.6900  172.4897   78.2551
   12.0270  173.0618   77.9691
   15.3640  173.6338   77.6831
   18.7010  174.2059   77.3971
   22.0380  174.7779   77.1110
   25.3750  175.3500   76.8250
   28.7120  175.9221   76.5390
   32.0490  176.4941   76.2529
   35.3860  177.0662   75.9669
   38.7230  177.6382   75.6809
   42.0600  178.2103   75.3949
   45.3971  178.7824   75.1088
   48.7341  179.3544   74.8228
   52.0711  179.9265   74.5368
   55.4081  180.4985   74.2507
   58.7451  181.0706   73.9647
   62.0821  181.6426   73.6787
   65.4191  182.2147   73.3926
   68.7561  182.7868   73.1066
   72.9471  183.6507   72.6555
   77.6456  184.6880   72.1064
   82.3442  185.7253   71.5572
   87.0427  186.7627   71.0080
   91.7412  187.8000   70.4588
   96.4397  188.8373   69.9096
  101.1382  189.8747   69.3605
  105.8367  190.9120   68.8113
  110.5352  191.9493   68.2621
  115.2337  192.9867   67.7129
  119.9322  194.0240   67.1638
  124.6307  195.0613   66.6146
  129.3293  196.0987   66.0654
  134.0278  197.1360   65.5162
  138.7263  198.1733   64.9671
  143.4248  199.2107   64.4179
  147.9899  200.4038   63.7525
  152.1305  202.0927   62.7174
  156.2711  203.7817   61.6822
  160.4118  205.4706   60.6471
  164.5524  207.1595   59.6119
  168.6930  208.8485   58.5768
  172.8336  210.5374   57.5416
  176.9742  212.2263   56.5064
  181.1148  213.9153   55.4713
  185.2555  215.6042   54.4361
  189.3961  217.2931   53.4010
  193.5367  218.9821   52.3658
  197.6773  220.6710   51.3307
  201.8179  222.3599   50.2955
  205.9585  224.0489   49.2604
  210.0992  225.7378   48.2252
  214.2398  227.4268   47.1901
  218.3804  229.1157   46.1549
  222.5210  230.8046   45.1197
  223.7783  230.2736   44.7925
  224.6584  229.4522   44.5578
  225.5385  228.6308   44.3231
  226.4186  227.8094   44.0884
  227.2986  226.9879   43.8537
  228.1787  226.1665   43.6190
  229.0588  225.3451   43.3843
  229.9389  224.5237   43.1496
  230.8190  223.7023   42.9149
  231.6991  222.8808   42.6802
  232.5792  222.0594   42.4456
  233.4593  221.2380   42.2109
  234.3394  220.4166   41.9762
  235.2195  219.5952   41.7415
  236.0995  218.7738   41.5068
  236.9796  217.9523   41.2721
  237.8597  217.1309   41.0374
  238.7398  216.3095   40.8027
  239.6199  215.4881   40.5680
  240.5000  214.6667   40.3333
  241.3801  213.8452   40.0986
  242.2602  213.0238   39.8640
  243.1403  212.2024   39.6293
  244.0204  211.3810   39.3946
  244.9005  210.5596   39.1599
  245.7805  209.7382   38.9252
  246.6606  208.9167   38.6905
  247.5407  208.0953   38.4558
  248.4208  207.2739   38.2211
  249.3009  206.4525   37.9864
  250.1810  205.6311   37.7517
  251.0611  204.8097   37.5170
  251.9412  203.9882   37.2824
  252.8213  203.1668   37.0477
  252.6036  200.6743   37.3436
  252.1061  197.7560   37.7747
  251.6087  194.8377   38.2058
  251.1113  191.9194   38.6369
  250.6138  189.0010   39.0680
  250.1164  186.0827   39.4991
  249.6189  183.1644   39.9303
  249.1215  180.2460   40.3614
  248.6240  177.3277   40.7925
  248.1266  174.4094   41.2236
  247.6292  171.4910   41.6547
  247.1317  168.5727   42.0858
  246.6343  165.6544   42.5170
  246.1368  162.7361   42.9481
  245.6394  159.8177   43.3792
  245.1419  156.8994   43.8103
  244.6445  153.9811   44.2414
  244.1471  151.0627   44.6725
  243.6496  148.1444   45.1037
  243.1522  145.2261   45.5348
  242.6547  142.3078   45.9659
  242.1573  139.3894   46.3970
  241.6598  136.4711   46.8281
  241.1624  133.5528   47.2592
  240.6650  130.6344   47.6904
  240.1675  127.7161   48.1215
  239.6701  124.7978   48.5526
  239.1726  121.8795   48.9837
  238.6752  118.9611   49.4148
  238.1777  116.0428   49.8460
  237.9526  113.8931   49.9526
  237.8787  112.1708   49.8787
  237.8049  110.4485   49.8049
  237.7311  108.7261   49.7311
  237.6573  107.0038   49.6573
  237.5835  105.2815   49.5835
  237.5097  103.5591   49.5097
  237.4359  101.8368   49.4359
  237.3620  100.1145   49.3620
  237.2882   98.3922   49.2882
  237.2144   96.6698   49.2144
  237.1406   94.9475   49.1406
  237.0668   93.2252   49.0668
  236.9930   91.5028   48.9930
  236.9192   89.7805   48.9192
  236.8454   88.0582   48.8454
  236.7715   86.3359   48.7715
  236.6977   84.6135   48.6977
  236.6239   82.8912   48.6239
  236.5501   81.1689   48.5501
  236.4763   79.4466   48.4763
  236.4025   77.7242   48.4025
  236.3287   76.0019   48.3287
  236.2548   74.2796   48.2548
  236.1810   72.5572   48.1810
  236.1072   70.8349   48.1072
  236.0334   69.1126   48.0334
  235.9596   67.3903   47.9596
  235.8858   65.6679   47.8858
  235.8120   63.9456   47.8120
  235.7381   62.2233   47.7381
  235.6643   60.5009   47.6643
  235.5905   58.7786   47.5905
  235.5167   57.0563   47.5167
  235.4429   55.3340   47.4429
  235.3691   53.6116   47.3691
  235.2953   51.8893   47.2953
  235.2214   50.1670   47.2214
  235.1476   48.4447   47.1476
  235.0738   46.7223   47.0738
  235.0000   45.0000   47.0000];
 
 

    
%... Interpolate get requested size for color table
pp=1:(m-1)/(size(c,1)-1):m;
r=interp1(pp,c(:,1),1:m);
g=interp1(pp,c(:,2),1:m);
b=interp1(pp,c(:,3),1:m);
%... Normalize to range [0,1], and divide again by maximum value
% to correct for round-off errors associated with the interpolation.
map=[r' g' b']/256;
map = map/max(map(:));


%% original color file
% x = ([30 83 129 174 206 231 259 311 357 419]-30)/(419-30); 
% cOrig = [ ...
% 042  061  153;
% 000  114  187;
% 000  167  134;
% 000  171  079;
% 070  183  073;
% 147  200  064;
% 223  231  045;
% 253  203  037;
% 238  115  050;
% 235  045  047;];
% 
% xI = linspace(0,1,256);
% rI = interp1(x,cOrig(:,1),xI)';
% gI = interp1(x,cOrig(:,2),xI)';
% bI = interp1(x,cOrig(:,3),xI)';
% c = [rI,gI,bI]













